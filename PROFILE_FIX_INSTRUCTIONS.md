# üîß –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö

## –ü—Ä–æ–±–ª–µ–º–∞
–¢–∞–±–ª–∏—Ü—è `user_profiles` –º–æ–∂–µ –Ω–µ –º–∞—Ç–∏ –≤—Å—ñ—Ö –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –ø–æ–ª—ñ–≤ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö (–±—ñ–æ, –¥–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è, —Ä–æ–±–æ—Ç–∞, –º—ñ—Å—Ç–æ, –≤–µ–±-—Å–∞–π—Ç, –æ—Å–≤—ñ—Ç–∞, –º–æ–≤–∏, —Ç–µ–ª–µ—Ñ–æ–Ω, —Ö–æ–±—ñ, —Å—ñ–º–µ–π–Ω–∏–π —Å—Ç–∞–Ω).

## –†—ñ—à–µ–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –í–∏–∫–æ–Ω–∞—Ç–∏ SQL –º—ñ–≥—Ä–∞—Ü—ñ—é –≤ Supabase Dashboard

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç Supabase: https://supabase.com/dashboard
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ —Ä–æ–∑–¥—ñ–ª—É **SQL Editor**
3. –í–∏–∫–æ–Ω–∞–π—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç –∑ —Ñ–∞–π–ª—É `create_user_profiles_table.sql` –∞–±–æ `20250128160000_add_missing_profile_fields.sql`

### –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ñ

–í–∏–∫–æ–Ω–∞–π—Ç–µ —Ü–µ–π SQL –∑–∞–ø–∏—Ç –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏:

```sql
SELECT column_name, data_type, is_nullable, column_default
FROM information_schema.columns 
WHERE table_name = 'user_profiles' 
AND table_schema = 'public'
ORDER BY ordinal_position;
```

### –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ RLS –ø–æ–ª—ñ—Ç–∏–∫–∏

–í–∏–∫–æ–Ω–∞–π—Ç–µ —Ü–µ–π –∑–∞–ø–∏—Ç –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø–æ–ª—ñ—Ç–∏–∫ –±–µ–∑–ø–µ–∫–∏:

```sql
SELECT schemaname, tablename, policyname, permissive, roles, cmd, qual, with_check
FROM pg_policies 
WHERE tablename = 'user_profiles';
```

### –ö—Ä–æ–∫ 4: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª `test_profile_table.html` —É –±—Ä–∞—É–∑–µ—Ä—ñ
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
   - "–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"
   - "–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—é"
   - "–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤–∏–π –ø—Ä–æ—Ñ—ñ–ª—å"
   - "–û–Ω–æ–≤–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å"

### –ö—Ä–æ–∫ 5: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤ –¥–æ–¥–∞—Ç–∫—É

1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –¥–æ–¥–∞—Ç–æ–∫: `npm run dev`
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –ø—Ä–æ—Ñ—ñ–ª—é
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É "üîç Test user_profiles Table"
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø–æ–º–∏–ª–æ–∫

## –û—á—ñ–∫—É–≤–∞–Ω—ñ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü—ñ user_profiles

- `id` (uuid, primary key)
- `auth_user_id` (uuid, foreign key –¥–æ auth.users)
- `name` (text, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ)
- `last_name` (text)
- `email` (text, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ)
- `avatar` (text)
- `bio` (text)
- `city` (text)
- `birth_date` (date)
- `education` (text)
- `phone` (text)
- `work` (text)
- `website` (text)
- `relationship_status` (text)
- `hobbies` (jsonb, –º–∞—Å–∏–≤ —Ä—è–¥–∫—ñ–≤)
- `languages` (jsonb, –º–∞—Å–∏–≤ —Ä—è–¥–∫—ñ–≤)
- `notifications` (jsonb)
- `privacy` (jsonb)
- `gender` (text, 'male'/'female'/'other')
- `looking_for_relationship` (boolean)
- `age` (integer)
- `email_verified` (boolean)
- `created_at` (timestamptz)
- `updated_at` (timestamptz)

## –§–∞–π–ª–∏, —è–∫—ñ –±—É–ª–∏ —Å—Ç–≤–æ—Ä–µ–Ω—ñ/–æ–Ω–æ–≤–ª–µ–Ω—ñ

1. **–ú—ñ–≥—Ä–∞—Ü—ñ—ó SQL:**
   - `supabase/migrations/20250128150000_create_user_profiles_table.sql`
   - `supabase/migrations/20250128160000_add_missing_profile_fields.sql`
   - `create_user_profiles_table.sql` (–¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è)

2. **–¢–µ—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏:**
   - `test_profile_table.html` (—Ç–µ—Å—Ç —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä)
   - `debug_profile.js` (Node.js —Å–∫—Ä–∏–ø—Ç)

3. **–û–Ω–æ–≤–ª–µ–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏:**
   - `src/pages/profile/ProfileNew.tsx` (–¥–æ–¥–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è)

## –°–µ—Ä–≤—ñ—Å–∏ —Ç–∞ —Ö—É–∫–∏

–ö–æ–¥ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –ø—Ä–æ—Ñ—ñ–ª–µ–º –≤–∂–µ –≥–æ—Ç–æ–≤–∏–π:

- **AuthUserService** (`src/lib/authUserService.ts`) - –æ—Å–Ω–æ–≤–Ω–∏–π —Å–µ—Ä–≤—ñ—Å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –ø—Ä–æ—Ñ—ñ–ª–µ–º
- **userProfileService** (`src/lib/userProfileService.ts`) - –¥–æ–ø–æ–º—ñ–∂–Ω–∏–π —Å–µ—Ä–≤—ñ—Å
- **useProfile** (`src/pages/profile/hooks/useProfile.ts`) - React —Ö—É–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç–∞–Ω–æ–º –ø—Ä–æ—Ñ—ñ–ª—é
- **ProfileEditForm** (`src/pages/profile/components/ProfileEditForm.tsx`) - —Ñ–æ—Ä–º–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è

## –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. –í–∏–∫–æ–Ω–∞–π—Ç–µ SQL –º—ñ–≥—Ä–∞—Ü—ñ—é –≤ Supabase Dashboard
2. –ü—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ —á–µ—Ä–µ–∑ `test_profile_table.html`
3. –ü—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ –≤ –¥–æ–¥–∞—Ç–∫—É —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "Test user_profiles Table"
4. –°–ø—Ä–æ–±—É–π—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏/—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å –≤ –¥–æ–¥–∞—Ç–∫—É
5. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤—Å—ñ –ø–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## –ú–æ–∂–ª–∏–≤—ñ –ø–æ–º–∏–ª–∫–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è

### –ü–æ–º–∏–ª–∫–∞: "relation 'user_profiles' does not exist"
**–†—ñ—à–µ–Ω–Ω—è:** –í–∏–∫–æ–Ω–∞–π—Ç–µ SQL –º—ñ–≥—Ä–∞—Ü—ñ—é –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ

### –ü–æ–º–∏–ª–∫–∞: "permission denied for table user_profiles"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ RLS –ø–æ–ª—ñ—Ç–∏–∫–∏ —Ç–∞ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É

### –ü–æ–º–∏–ª–∫–∞: "column does not exist"
**–†—ñ—à–µ–Ω–Ω—è:** –í–∏–∫–æ–Ω–∞–π—Ç–µ –º—ñ–≥—Ä–∞—Ü—ñ—é –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –≤—ñ–¥—Å—É—Ç–Ω—ñ—Ö –ø–æ–ª—ñ–≤

### –ü–æ–º–∏–ª–∫–∞: "invalid input syntax for type json"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ hobbies —Ç–∞ languages –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è —è–∫ –º–∞—Å–∏–≤–∏